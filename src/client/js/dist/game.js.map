{"version":3,"sources":["webpack:///game.js","webpack:///webpack/bootstrap 396e7c3abfb4588cffb7","webpack:///./src/client/js/src/game.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","value","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","_slicedToArray","sliceIterator","arr","_arr","_n","_d","_e","undefined","_s","_i","Symbol","iterator","next","done","push","length","err","Array","isArray","TypeError","io","$","Vue","updateException","objectType","instanceId","changedProp","entities","xCenter","x","width","yCenter","y","height","update","ctx","clearRect","drawMap","drawEntities","coors","getRelativeCoors","left","top","drawImage","background","keys","reduce","acc","id","concat","sort","a","b","forEach","entity","type","updatePosition","fillStyle","fillText","strokeRect","color","fillRect","hp","maxHp","console","warn","showHitboxes","strokeStyle","Math","floor","random","drawShape","hitboxPoints","map","_ref","_ref2","clientId","hspeed","vspeed","points","fill","arguments","beginPath","moveTo","lineTo","closePath","stroke","rightKey","upKey","leftKey","downKey","app","el","data","messages","msg","items","canvas","document","getElementById","getContext","mozImageSmoothingEnabled","webkitImageSmoothingEnabled","msImageSmoothingEnabled","imageSmoothingEnabled","textAlign","textboxFocused","tileSize","fps","Image","src","spritesheet","commands","help","debug","variable","socket","emit","eval","hitboxes","show","on","log","types","setInterval","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","removed","return","instanceIds","j","changes","k","changedVal","ready","e","rect","getBoundingClientRect","clientX","clientY","preventDefault","focus","message","val","charAt","inputs","substr","split","apply","slice","blur","key","keyCode","indexOf","jQuery"],"mappings":"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","file":"game.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"/dist/\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\n(function (io, $, Vue) {\n    'use strict';\n\n    var width = 800;\n    var height = 600;\n\n    var rightKey = 68;\n    var upKey = 87;\n    var leftKey = 65;\n    var downKey = 83;\n\n    var app = new Vue({\n        el: '#game',\n        data: {\n            messages: [{\n                type: 'info',\n                msg: 'Welcome to the game!'\n            }],\n            items: []\n        }\n    });\n\n    var canvas = document.getElementById('viewport');\n    var ctx = canvas.getContext('2d');\n    ctx.mozImageSmoothingEnabled = false;\n    ctx.webkitImageSmoothingEnabled = false;\n    ctx.msImageSmoothingEnabled = false;\n    ctx.imageSmoothingEnabled = false;\n    ctx.textAlign = 'center';\n\n    var textboxFocused = false;\n\n    var entities = {};\n    var clientId = '';\n    var tileSize = 16;\n    var fps = 60;\n    var showHitboxes = false;\n\n    var background = new Image();\n    background.src = '../img/grass.png';\n    var spritesheet = new Image();\n    spritesheet.src = '../img/spritesheet.png';\n\n    var commands = {\n        help: function help() {\n            app.messages.push({\n                type: 'info',\n                msg: 'Commands:\\n/help - List all commands'\n            });\n        },\n        debug: function debug(variable) {\n            socket.emit('clientDebug', variable + ': ' + eval(variable));\n        },\n        hitboxes: function hitboxes() {\n            var show = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : !showHitboxes;\n\n            showHitboxes = show;\n        }\n    };\n\n    var socket = io();\n\n    socket.on('init', function (data) {\n        console.log(data);\n        entities = data.entities;\n        Object.keys(entities).forEach(function (id) {\n            entities[id].id = id;\n            entities[id].type = entities[id].types[entities[id].types.length - 1];\n        });\n        clientId = data.clientId;\n        setInterval(update, 1000 / fps);\n    });\n\n    socket.on('update', function (data) {\n        //console.log(entities, clientId);//console.log(data);\n        var _iteratorNormalCompletion = true;\n        var _didIteratorError = false;\n        var _iteratorError = undefined;\n\n        try {\n            for (var _iterator = data.removed[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                var removed = _step.value;\n\n                delete entities[removed.id];\n            }\n        } catch (err) {\n            _didIteratorError = true;\n            _iteratorError = err;\n        } finally {\n            try {\n                if (!_iteratorNormalCompletion && _iterator.return) {\n                    _iterator.return();\n                }\n            } finally {\n                if (_didIteratorError) {\n                    throw _iteratorError;\n                }\n            }\n        }\n\n        var instanceIds = Object.keys(data.entities);\n        for (var j = 0; j < instanceIds.length; j++) {\n            var instanceId = instanceIds[j];\n            var changes = Object.keys(data.entities[instanceId]);\n            for (var k = 0; k < changes.length; k++) {\n                var changedProp = changes[k];\n                var changedVal = data.entities[instanceId][changedProp];\n                if (!entities[instanceId]) {\n                    entities[instanceId] = data.entities[instanceId];\n                    entities[instanceId].type = entities[instanceId].types[entities[instanceId].types.length - 1];console.log(entities[instanceId].type);\n                    entities[instanceId].id = instanceId;\n                } else {\n                    entities[instanceId][changedProp] = changedVal;\n                    updateException('', instanceId, changedProp);\n                }\n            }\n        }\n        //app.$set(app, 'items', data.inventory.items);\n    });\n\n    socket.on('chatMsg', function (data) {\n        app.messages = app.messages.concat([data]);\n    });\n\n    $(document).ready(function () {\n\n        $('#viewport').on('mousedown', function (e) {\n            console.log('click');\n            var rect = canvas.getBoundingClientRect();\n            socket.emit('click', {\n                x: e.clientX - rect.left - width / 2 + entities[clientId].x,\n                y: e.clientY - rect.top - height / 2 + entities[clientId].y\n            });\n        });\n\n        $('#game-cont').on('contextmenu', function (e) {\n            e.preventDefault();\n        });\n\n        $('#chat-input, .login-input').on(\"focus\", function () {\n            textboxFocused = true;\n        }).on(\"blur\", function () {\n            textboxFocused = false;\n        });\n\n        $('#chat-cont').on('click', function (e) {\n            $('#chat-input').focus();\n        });\n\n        $('#chat-form').on('submit', function (e) {\n            e.preventDefault();\n            var message = $('#chat-input').val();\n            if (message.charAt(0) === '/') {\n                var inputs = message.substr(1).split(' ');\n                if (commands[inputs[0]]) {\n                    commands[inputs[0]].apply(null, inputs.slice(1));\n                } else {\n                    socket.emit('chatMsg', message.substr(0, 140));\n                }\n            } else {\n                socket.emit('chatMsg', message.substr(0, 140));\n            }\n            $('#chat-input').blur();\n            $('#chat-input').val('');\n            textboxFocused = false;\n        });\n    }).on('keydown', function (e) {\n        if (!textboxFocused) {\n            socket.emit('keyDown', {\n                key: e.keyCode\n            });\n            if ([rightKey, upKey, leftKey, downKey].indexOf(e.keyCode) !== -1) {\n                e.preventDefault();\n            }\n            if (e.keyCode === 84) {\n                $('#chat-input').focus();\n                e.preventDefault();\n            }\n            if (e.keyCode === 191) {\n                $('#chat-input').focus();\n            }\n        }\n    }).on('keyup', function (e) {\n        socket.emit('keyUp', {\n            key: e.keyCode\n        });\n    });\n\n    function updateException(objectType, instanceId, changedProp) {\n        var object = entities[instanceId];\n        if (objectType === 'Player') {\n            if (changedProp === 'x') {\n                object.xCenter = object.x + object.width / 2;\n            } else if (changedProp === 'y') {\n                object.yCenter = object.y + object.height / 2;\n            }\n        }\n    }\n\n    function update() {\n        ctx.clearRect(0, 0, width, height);\n        drawMap();\n        drawEntities();\n    }\n\n    function drawMap() {\n        var coors = getRelativeCoors([0, 0]);\n        var left = coors[0];\n        var top = coors[1];\n        for (var x = 0; x < width; x += 480) {\n            for (var y = 0; y < height; y += 480) {\n                ctx.drawImage(background, left + x, top + y, 480, 480);\n            }\n        }\n        /*map.forEach((row, y) => {\n            row.forEach((tile, x) => {\n                ctx.drawImage(spritesheet, (tile * (tileSize + 1)) % 968, tile * (tileSize + 1), tileSize, tileSize, left + x * tileSize, top + y * tileSize, tileSize, tileSize);\n            });\n        });*/\n    }\n\n    function drawEntities() {\n        Object.keys(entities).reduce(function (acc, id) {\n            return acc.concat(entities[id]);\n        }, []).sort(function (a, b) {\n            return a.y + a.height > b.y + b.height;\n        }).forEach(function (entity) {\n            var coors = getRelativeCoors([entity.x, entity.y]);\n            var x = coors[0];\n            var y = coors[1];\n            switch (entity.type) {\n                case 'Player':\n                    updatePosition(entity);\n                    ctx.fillStyle = 'black';\n                    ctx.fillText(entity.name, x + 8, y - 12);\n                    ctx.strokeRect(x, y, 16, 16);\n                    ctx.fillStyle = entity.color;\n                    ctx.fillRect(x, y, 16, 16);\n                    //if (id === clientId){\n                    ctx.fillStyle = 'black';\n                    ctx.fillRect(x - 4, y - 8, 24, 4);\n                    ctx.fillStyle = 'red';\n                    ctx.fillRect(x - 4, y - 8, 24 * entity.hp / entity.maxHp, 4);\n                    //}\n                    break;\n                case 'Bullet':\n                    updatePosition(entity);\n                    ctx.strokeRect(x, y, 16, 16);\n                    ctx.fillStyle = 'black';\n                    ctx.fillRect(x, y, 16, 16);\n                    break;\n                case 'Enemy':\n                    updatePosition(entity);\n                    ctx.strokeRect(x, y, 16, 16);\n                    ctx.fillStyle = '#922';\n                    ctx.fillRect(x, y, 16, 16);\n                    ctx.fillStyle = 'black';\n                    ctx.fillRect(x - 4, y - 8, 24, 4);\n                    ctx.fillStyle = 'red';\n                    ctx.fillRect(x - 4, y - 8, 24 * entity.hp / entity.maxHp, 4);\n                    ctx.fillStyle = 'black';\n                    ctx.fillText(entity.name, x + 8, y - 12);\n                    break;\n                case 'ItemDrop':\n                    updatePosition(entity);\n                    ctx.strokeRect(x, y, 16, 16);\n                    ctx.fillStyle = 'pink';\n                    ctx.fillRect(x, y, 16, 16);\n                    break;\n                default:\n                    console.warn('unrecognized type ' + entity.type);\n                    break;\n            }\n            if (showHitboxes) {\n                ctx.strokeStyle = 'rgb(' + Math.floor(Math.random() * 256) + ',' + Math.floor(Math.random() * 256) + ',' + Math.floor(Math.random() * 256) + ')';\n                drawShape(entity.hitboxPoints.map(function (_ref) {\n                    var _ref2 = _slicedToArray(_ref, 2),\n                        x = _ref2[0],\n                        y = _ref2[1];\n\n                    return getRelativeCoors([x, y]);\n                }));\n            }\n        });\n    }\n\n    function getRelativeCoors(coors) {\n        return entities[clientId] ? [coors[0] - entities[clientId].x + width / 2, coors[1] - entities[clientId].y + height / 2] : [0, 0];\n    }\n\n    function updatePosition(entity) {\n        entity.x += entity.hspeed / 2;\n        entity.y += entity.vspeed / 2;\n    }\n\n    function drawShape(points) {\n        var fill = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n        ctx.beginPath();\n        ctx.moveTo(points[0][0], points[0][1]);\n        points.forEach(function (coors) {\n            ctx.lineTo(coors[0], coors[1]);\n        });\n        ctx.closePath();\n        if (fill) {\n            ctx.fill();\n        } else {\n            ctx.stroke();\n        }\n    }\n})(io, jQuery, Vue);\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// game.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 396e7c3abfb4588cffb7","(function(io, $, Vue){\n    'use strict';\n    \n    let width = 800;\n    let height = 600;\n    \n    let rightKey = 68;\n    let upKey = 87;\n    let leftKey = 65;\n    let downKey = 83;\n    \n    let app = new Vue({\n        el: '#game',\n        data: {\n            messages: [{\n                type: 'info',\n                msg: 'Welcome to the game!'\n            }],\n            items: []\n        }\n    });\n    \n    let canvas = document.getElementById('viewport');\n    let ctx = canvas.getContext('2d');\n    ctx.mozImageSmoothingEnabled = false;\n    ctx.webkitImageSmoothingEnabled = false;\n    ctx.msImageSmoothingEnabled = false;\n    ctx.imageSmoothingEnabled = false;\n    ctx.textAlign = 'center';\n    \n    let textboxFocused = false;\n    \n    let entities = {};\n    let clientId = '';\n    let tileSize = 16;\n    let fps = 60;\n    let showHitboxes = false;\n    \n    let background = new Image();\n    background.src = '../img/grass.png';\n    let spritesheet = new Image();\n    spritesheet.src = '../img/spritesheet.png';\n    \n    const commands = {\n        help: function(){\n            app.messages.push({\n                type: 'info',\n                msg: 'Commands:\\n/help - List all commands'\n            });\n        },\n        debug: function(variable){\n            socket.emit('clientDebug', variable + ': ' + eval(variable));\n        },\n        hitboxes: function(show = !showHitboxes){\n            showHitboxes = show;\n        }\n    };\n    \n    let socket = io();\n    \n    socket.on('init', function(data){console.log(data);\n        entities = data.entities;\n        Object.keys(entities).forEach(id => {\n            entities[id].id = id;\n            entities[id].type = entities[id].types[entities[id].types.length - 1];\n        });\n        clientId = data.clientId;\n        setInterval(update, 1000 / fps);\n    });\n    \n    socket.on('update', function(data){//console.log(entities, clientId);//console.log(data);\n        for (let removed of data.removed){\n            delete entities[removed.id];\n        }\n        \n        let instanceIds = Object.keys(data.entities);\n        for (let j = 0; j < instanceIds.length; j ++){\n            let instanceId = instanceIds[j];\n            let changes = Object.keys(data.entities[instanceId]);\n            for (let k = 0; k < changes.length; k ++){\n                let changedProp = changes[k];\n                let changedVal = data.entities[instanceId][changedProp];\n                if (!entities[instanceId]){\n                    entities[instanceId] = data.entities[instanceId];\n                    entities[instanceId].type = entities[instanceId].types[entities[instanceId].types.length - 1];console.log(entities[instanceId].type);\n                    entities[instanceId].id = instanceId;\n                } else {\n                    entities[instanceId][changedProp] = changedVal;\n                    updateException('', instanceId, changedProp);\n                }\n            }\n        }\n        //app.$set(app, 'items', data.inventory.items);\n    });\n    \n    socket.on('chatMsg', data => {\n        app.messages = app.messages.concat([data]);\n    });\n    \n    $(document)\n        .ready(function(){\n            \n            $('#viewport').on('mousedown', function(e){console.log('click');\n                let rect = canvas.getBoundingClientRect();\n                socket.emit('click', {\n                    x: e.clientX - rect.left - width / 2 + entities[clientId].x,\n                    y: e.clientY - rect.top - height / 2 + entities[clientId].y\n                });\n            });\n            \n            $('#game-cont').on('contextmenu', function(e){\n                e.preventDefault();\n            });\n            \n            $('#chat-input, .login-input')\n                .on(\"focus\", function(){\n                    textboxFocused = true;\n                })\n                .on(\"blur\", function(){\n                    textboxFocused = false;\n                });\n            \n            $('#chat-cont').on('click', function(e){\n                $('#chat-input').focus();\n            });\n            \n            $('#chat-form').on('submit', function(e){\n                e.preventDefault();\n                let message = $('#chat-input').val();\n                if (message.charAt(0) === '/'){\n                    let inputs = message.substr(1).split(' ');\n                    if (commands[inputs[0]]){\n                        commands[inputs[0]].apply(null, inputs.slice(1));\n                    } else {\n                        socket.emit('chatMsg', message.substr(0, 140));\n                    }\n                } else {\n                    socket.emit('chatMsg', message.substr(0, 140));\n                }\n                $('#chat-input').blur();\n                $('#chat-input').val('');\n                textboxFocused = false;\n                \n            });\n            \n        })\n        .on('keydown', function(e){\n            if (!textboxFocused){\n                socket.emit('keyDown', {\n                    key: e.keyCode\n                });\n                if ([rightKey, upKey, leftKey, downKey].indexOf(e.keyCode) !== -1){\n                    e.preventDefault();\n                }\n                if (e.keyCode === 84){\n                    $('#chat-input').focus();\n                    e.preventDefault();\n                }\n                if (e.keyCode === 191){\n                    $('#chat-input').focus();\n                }\n            }\n        })\n        .on('keyup', function(e){\n            socket.emit('keyUp', {\n                key: e.keyCode\n            });\n        });\n    \n    function updateException(objectType, instanceId, changedProp){\n        let object = entities[instanceId];\n        if (objectType === 'Player'){\n            if (changedProp === 'x'){\n                object.xCenter = object.x + object.width / 2;\n            } else if (changedProp === 'y'){\n                object.yCenter = object.y + object.height / 2;\n            }\n        }\n    }\n    \n    function update(){\n        ctx.clearRect(0, 0, width, height);\n        drawMap();\n        drawEntities();\n    }\n    \n    function drawMap(){\n        let coors = getRelativeCoors([0, 0]);\n        let left = coors[0];\n        let top = coors[1];\n        for (let x = 0; x < width; x += 480){\n            for (let y = 0; y < height; y += 480){\n                ctx.drawImage(background, left + x, top + y, 480, 480);\n            }\n        }\n        /*map.forEach((row, y) => {\n            row.forEach((tile, x) => {\n                ctx.drawImage(spritesheet, (tile * (tileSize + 1)) % 968, tile * (tileSize + 1), tileSize, tileSize, left + x * tileSize, top + y * tileSize, tileSize, tileSize);\n            });\n        });*/\n    }\n    \n    function drawEntities(){\n        Object.keys(entities)  \n            .reduce((acc, id) => acc.concat(entities[id]), [])\n            .sort((a, b) => a.y + a.height > b.y + b.height)\n            .forEach(entity => {\n                let coors = getRelativeCoors([entity.x, entity.y]);\n                let x = coors[0];\n                let y = coors[1];\n                switch (entity.type){\n                    case 'Player':\n                        updatePosition(entity);\n                        ctx.fillStyle = 'black';\n                        ctx.fillText(entity.name, x + 8, y - 12);\n                        ctx.strokeRect(x, y, 16, 16);\n                        ctx.fillStyle = entity.color;\n                        ctx.fillRect(x, y, 16, 16);\n                        //if (id === clientId){\n                            ctx.fillStyle = 'black';\n                            ctx.fillRect(x - 4, y - 8, 24, 4);\n                            ctx.fillStyle = 'red';\n                            ctx.fillRect(x - 4, y - 8, 24 * entity.hp / entity.maxHp, 4);\n                        //}\n                        break;\n                    case 'Bullet':\n                        updatePosition(entity);\n                        ctx.strokeRect(x, y, 16, 16);\n                        ctx.fillStyle = 'black';\n                        ctx.fillRect(x, y, 16, 16);\n                        break;\n                    case 'Enemy':\n                        updatePosition(entity);\n                        ctx.strokeRect(x, y, 16, 16);\n                        ctx.fillStyle = '#922';\n                        ctx.fillRect(x, y, 16, 16);\n                        ctx.fillStyle = 'black';\n                        ctx.fillRect(x - 4, y - 8, 24, 4);\n                        ctx.fillStyle = 'red';\n                        ctx.fillRect(x - 4, y - 8, 24 * entity.hp / entity.maxHp, 4);\n                        ctx.fillStyle = 'black';\n                        ctx.fillText(entity.name, x + 8, y - 12);\n                        break;\n                    case 'ItemDrop':\n                        updatePosition(entity);\n                        ctx.strokeRect(x, y, 16, 16);\n                        ctx.fillStyle = 'pink';\n                        ctx.fillRect(x, y, 16, 16);\n                        break;\n                    default:\n                        console.warn('unrecognized type ' + entity.type);\n                        break;\n                }\n                if (showHitboxes){\n                    ctx.strokeStyle = 'rgb(' + Math.floor(Math.random()*256) + ',' + Math.floor(Math.random()*256) + ',' + Math.floor(Math.random()*256) + ')';\n                    drawShape(entity.hitboxPoints.map(([x, y]) => getRelativeCoors([x, y])));\n                }\n            });\n    }\n    \n    function getRelativeCoors(coors){\n        return entities[clientId] ? [coors[0] - entities[clientId].x + width / 2, coors[1] - entities[clientId].y + height / 2] : [0, 0];\n    }\n    \n    function updatePosition(entity){\n        entity.x += entity.hspeed / 2;\n        entity.y += entity.vspeed / 2;\n    }\n    \n    function drawShape(points, fill = false){\n        ctx.beginPath();\n        ctx.moveTo(points[0][0], points[0][1]);\n        points.forEach(coors => {\n            ctx.lineTo(coors[0], coors[1]);\n        });\n        ctx.closePath();\n        if (fill){\n            ctx.fill();\n        } else {\n            ctx.stroke();\n        }\n    }\n    \n})(io, jQuery, Vue);\n\n\n\n// WEBPACK FOOTER //\n// ./src/client/js/src/game.js"],"sourceRoot":""}