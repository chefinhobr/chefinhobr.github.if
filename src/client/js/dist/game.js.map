{"version":3,"sources":["webpack:///game.js","webpack:///webpack/bootstrap 1793b269d9e6169dcf5e","webpack:///./src/client/js/src/game.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","value","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","io","$","Vue","updateException","objectType","instanceId","changedProp","entities","xCenter","x","width","yCenter","y","height","update","ctx","clearRect","drawMap","drawEntities","coors","getRelativeCoors","left","top","drawImage","background","keys","reduce","acc","id","concat","sort","a","b","forEach","entity","type","updatePosition","fillStyle","fillText","strokeRect","color","fillRect","hp","maxHp","console","warn","clientId","hspeed","vspeed","rightKey","upKey","leftKey","downKey","app","el","data","messages","msg","items","canvas","document","getElementById","getContext","mozImageSmoothingEnabled","webkitImageSmoothingEnabled","msImageSmoothingEnabled","imageSmoothingEnabled","textAlign","textboxFocused","map","tileSize","fps","Image","src","spritesheet","commands","help","push","debug","variable","socket","emit","eval","on","log","types","length","setInterval","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","removed","Symbol","iterator","next","done","err","return","instanceIds","j","changes","k","changedVal","ready","e","rect","getBoundingClientRect","clientX","clientY","preventDefault","focus","message","val","charAt","inputs","substr","split","apply","slice","blur","key","keyCode","indexOf","jQuery"],"mappings":"CAAS,SAAUA,GCInB,QAAAC,GAAAC,GAGA,GAAAC,EAAAD,GACA,MAAAC,GAAAD,GAAAE,OAGA,IAAAC,GAAAF,EAAAD,IACAI,EAAAJ,EACAK,GAAA,EACAH,WAUA,OANAJ,GAAAE,GAAAM,KAAAH,EAAAD,QAAAC,IAAAD,QAAAH,GAGAI,EAAAE,GAAA,EAGAF,EAAAD,QAvBA,GAAAD,KA4BAF,GAAAQ,EAAAT,EAGAC,EAAAS,EAAAP,EAGAF,EAAAK,EAAA,SAAAK,GAA2C,MAAAA,IAG3CV,EAAAW,EAAA,SAAAR,EAAAS,EAAAC,GACAb,EAAAc,EAAAX,EAAAS,IACAG,OAAAC,eAAAb,EAAAS,GACAK,cAAA,EACAC,YAAA,EACAC,IAAAN,KAMAb,EAAAoB,EAAA,SAAAhB,GACA,GAAAS,GAAAT,KAAAiB,WACA,WAA2B,MAAAjB,GAAA,SAC3B,WAAiC,MAAAA,GAEjC,OADAJ,GAAAW,EAAAE,EAAA,IAAAA,GACAA,GAIAb,EAAAc,EAAA,SAAAQ,EAAAC,GAAsD,MAAAR,QAAAS,UAAAC,eAAAlB,KAAAe,EAAAC,IAGtDvB,EAAA0B,EAAA,SAGA1B,IAAA2B,EAAA,KDMM,SAAUvB,OAAQD,QAASH,qBAEjC,cExEA,SAAU4B,GAAIC,EAAGC,KA4Kb,QAASC,iBAAgBC,EAAYC,EAAYC,GAC7C,GAAIZ,GAASa,SAASF,EACH,YAAfD,IACoB,MAAhBE,EACAZ,EAAOc,QAAUd,EAAOe,EAAIf,EAAOgB,MAAQ,EACpB,MAAhBJ,IACPZ,EAAOiB,QAAUjB,EAAOkB,EAAIlB,EAAOmB,OAAS,IAKxD,QAASC,UACLC,IAAIC,UAAU,EAAG,EAAGN,MAAOG,QAC3BI,UACAC,eAGJ,QAASD,WAIL,IAAK,GAHDE,GAAQC,kBAAkB,EAAG,IAC7BC,EAAOF,EAAM,GACbG,EAAMH,EAAM,GACPV,EAAI,EAAGA,EAAIC,MAAOD,GAAK,IAC5B,IAAK,GAAIG,GAAI,EAAGA,EAAIC,OAAQD,GAAK,IAC7BG,IAAIQ,UAAUC,WAAYH,EAAOZ,EAAGa,EAAMV,EAAG,IAAK,KAU9D,QAASM,gBACL/B,OAAOsC,KAAKlB,UACPmB,OAAO,SAACC,EAAKC,GAAN,MAAaD,GAAIE,OAAOtB,SAASqB,SACxCE,KAAK,SAACC,EAAGC,GAAJ,MAAUD,GAAEnB,EAAImB,EAAElB,OAASmB,EAAEpB,EAAIoB,EAAEnB,SACxCoB,QAAQ,SAAAC,GACL,GAAIf,GAAQC,kBAAkBc,EAAOzB,EAAGyB,EAAOtB,IAC3CH,EAAIU,EAAM,GACVP,EAAIO,EAAM,EACd,QAAQe,EAAOC,MACX,IAAK,SACDC,eAAeF,GACfnB,IAAIsB,UAAY,QAChBtB,IAAIuB,SAASJ,EAAOlD,KAAMyB,EAAI,EAAGG,EAAI,IACrCG,IAAIwB,WAAW9B,EAAGG,EAAG,GAAI,IACzBG,IAAIsB,UAAYH,EAAOM,MACvBzB,IAAI0B,SAAShC,EAAGG,EAAG,GAAI,IAEnBG,IAAIsB,UAAY,QAChBtB,IAAI0B,SAAShC,EAAI,EAAGG,EAAI,EAAG,GAAI,GAC/BG,IAAIsB,UAAY,MAChBtB,IAAI0B,SAAShC,EAAI,EAAGG,EAAI,EAAG,GAAKsB,EAAOQ,GAAKR,EAAOS,MAAO,EAE9D,MACJ,KAAK,SACDP,eAAeF,GACfnB,IAAIwB,WAAW9B,EAAGG,EAAG,GAAI,IACzBG,IAAIsB,UAAY,QAChBtB,IAAI0B,SAAShC,EAAGG,EAAG,GAAI,GACvB,MACJ,KAAK,QACDwB,eAAeF,GACfnB,IAAIwB,WAAW9B,EAAGG,EAAG,GAAI,IACzBG,IAAIsB,UAAY,OAChBtB,IAAI0B,SAAShC,EAAGG,EAAG,GAAI,IACvBG,IAAIsB,UAAY,QAChBtB,IAAI0B,SAAShC,EAAI,EAAGG,EAAI,EAAG,GAAI,GAC/BG,IAAIsB,UAAY,MAChBtB,IAAI0B,SAAShC,EAAI,EAAGG,EAAI,EAAG,GAAKsB,EAAOQ,GAAKR,EAAOS,MAAO,GAC1D5B,IAAIsB,UAAY,QAChBtB,IAAIuB,SAASJ,EAAOlD,KAAMyB,EAAI,EAAGG,EAAI,GACrC,MACJ,KAAK,WACDwB,eAAeF,GACfnB,IAAIwB,WAAW9B,EAAGG,EAAG,GAAI,IACzBG,IAAIsB,UAAY,OAChBtB,IAAI0B,SAAShC,EAAGG,EAAG,GAAI,GACvB,MACJ,SACIgC,QAAQC,KAAK,qBAAuBX,EAAOC,SAM/D,QAASf,kBAAiBD,GACtB,MAAOZ,UAASuC,WAAa3B,EAAM,GAAKZ,SAASuC,UAAUrC,EAAIC,MAAQ,EAAGS,EAAM,GAAKZ,SAASuC,UAAUlC,EAAIC,OAAS,IAAM,EAAG,GAGlI,QAASuB,gBAAeF,GACpBA,EAAOzB,GAAKyB,EAAOa,OAAS,EAC5Bb,EAAOtB,GAAKsB,EAAOc,OAAS,EAtQhC,GAAItC,OAAQ,IACRG,OAAS,IAEToC,SAAW,GACXC,MAAQ,GACRC,QAAU,GACVC,QAAU,GAEVC,IAAM,GAAInD,MACVoD,GAAI,QACJC,MACIC,WACIrB,KAAM,OACNsB,IAAK,yBAETC,YAIJC,OAASC,SAASC,eAAe,YACjC9C,IAAM4C,OAAOG,WAAW,KAC5B/C,KAAIgD,0BAA2B,EAC/BhD,IAAIiD,6BAA8B,EAClCjD,IAAIkD,yBAA0B,EAC9BlD,IAAImD,uBAAwB,EAC5BnD,IAAIoD,UAAY,QAEhB,IAAIC,iBAAiB,EAEjB7D,YACA8D,MACC,EAAG,EAAG,EAAG,EAAG,IACZ,EAAG,EAAG,EAAG,EAAG,IACZ,EAAG,EAAG,EAAG,EAAG,IACZ,EAAG,EAAG,EAAG,EAAG,IACZ,EAAG,EAAG,EAAG,EAAG,IAEbvB,SAAW,GACXwB,SAAW,GACXC,IAAM,GAEN/C,WAAa,GAAIgD,MACrBhD,YAAWiD,IAAM,kBACjB,IAAIC,aAAc,GAAIF,MACtBE,aAAYD,IAAM,wBAElB,IAAME,WACFC,KAAM,WACFvB,IAAIG,SAASqB,MACT1C,KAAM,OACNsB,IAAK,0CAGbqB,MAAO,QAAAA,OAASC,UACZC,OAAOC,KAAK,cAAeF,SAAW,KAAOG,KAAKH,aAItDC,OAAShF,IAEbgF,QAAOG,GAAG,OAAQ,SAAS5B,GAAMX,QAAQwC,IAAI7B,GACzChD,SAAWgD,EAAKhD,SAChBpB,OAAOsC,KAAKlB,UAAU0B,QAAQ,SAAAL,GAC1BrB,SAASqB,GAAIA,GAAKA,EAClBrB,SAASqB,GAAIO,KAAO5B,SAASqB,GAAIyD,MAAM9E,SAASqB,GAAIyD,MAAMC,OAAS,KAEvExC,SAAWS,EAAKT,SAChByC,YAAYzE,OAAQ,IA5Bd,MA+BVkE,OAAOG,GAAG,SAAU,SAAS5B,GAAK,GAAAiC,IAAA,EAAAC,GAAA,EAAAC,MAAAC,EAAA,KAC9B,OAAAC,GAAAC,EAAoBtC,EAAKuC,QAAzBC,OAAAC,cAAAR,GAAAI,EAAAC,EAAAI,QAAAC,MAAAV,GAAA,EAAiC,IAAxBM,GAAwBF,EAAA9G,YACtByB,UAASuF,EAAQlE,KAFE,MAAAuE,GAAAV,GAAA,EAAAC,EAAAS,EAAA,aAAAX,GAAAK,EAAAO,QAAAP,EAAAO,SAAA,WAAAX,EAAA,KAAAC,IAM9B,IAAK,GADDW,GAAclH,OAAOsC,KAAK8B,EAAKhD,UAC1B+F,EAAI,EAAGA,EAAID,EAAYf,OAAQgB,IAGpC,IAAK,GAFDjG,GAAagG,EAAYC,GACzBC,EAAUpH,OAAOsC,KAAK8B,EAAKhD,SAASF,IAC/BmG,EAAI,EAAGA,EAAID,EAAQjB,OAAQkB,IAAK,CACrC,GAAIlG,GAAciG,EAAQC,GACtBC,EAAalD,EAAKhD,SAASF,GAAYC,EACtCC,UAASF,IAKVE,SAASF,GAAYC,GAAemG,EACpCtG,gBAAgB,GAAIE,EAAYC,KALhCC,SAASF,GAAckD,EAAKhD,SAASF,GACrCE,SAASF,GAAY8B,KAAO5B,SAASF,GAAYgF,MAAM9E,SAASF,GAAYgF,MAAMC,OAAS,GAAG1C,QAAQwC,IAAI7E,SAASF,GAAY8B,MAC/H5B,SAASF,GAAYuB,GAAKvB,MAU1C2E,OAAOG,GAAG,UAAW,SAAA5B,GACjBF,IAAIG,SAAWH,IAAIG,SAAS3B,QAAQ0B,MAGxCtD,EAAE2D,UACG8C,MAAM,WAEHzG,EAAE,aAAakF,GAAG,YAAa,SAASwB,GAAG/D,QAAQwC,IAAI,QACnD,IAAIwB,GAAOjD,OAAOkD,uBAClB7B,QAAOC,KAAK,SACRxE,EAAGkG,EAAEG,QAAUF,EAAKvF,KAAOX,MAAQ,EAAIH,SAASuC,UAAUrC,EAC1DG,EAAG+F,EAAEI,QAAUH,EAAKtF,IAAMT,OAAS,EAAIN,SAASuC,UAAUlC,MAIlEX,EAAE,cAAckF,GAAG,cAAe,SAASwB,GACvCA,EAAEK,mBAGN/G,EAAE,6BACGkF,GAAG,QAAS,WACTf,gBAAiB,IAEpBe,GAAG,OAAQ,WACRf,gBAAiB,IAGzBnE,EAAE,cAAckF,GAAG,QAAS,SAASwB,GACjC1G,EAAE,eAAegH,UAGrBhH,EAAE,cAAckF,GAAG,SAAU,SAASwB,GAClCA,EAAEK,gBACF,IAAIE,GAAUjH,EAAE,eAAekH,KAC/B,IAA0B,MAAtBD,EAAQE,OAAO,GAAW,CAC1B,GAAIC,GAASH,EAAQI,OAAO,GAAGC,MAAM,IACjC5C,UAAS0C,EAAO,IAChB1C,SAAS0C,EAAO,IAAIG,MAAM,KAAMH,EAAOI,MAAM,IAE7CzC,OAAOC,KAAK,UAAWiC,EAAQI,OAAO,EAAG,UAG7CtC,QAAOC,KAAK,UAAWiC,EAAQI,OAAO,EAAG,KAE7CrH,GAAE,eAAeyH,OACjBzH,EAAE,eAAekH,IAAI,IACrB/C,gBAAiB,MAKxBe,GAAG,UAAW,SAASwB,GACfvC,iBACDY,OAAOC,KAAK,WACR0C,IAAKhB,EAAEiB,WAEqD,KApJ7D,GACH,GACE,GACA,IAiJsCC,QAAQlB,EAAEiB,UAC9CjB,EAAEK,iBAEY,KAAdL,EAAEiB,UACF3H,EAAE,eAAegH,QACjBN,EAAEK,kBAEY,MAAdL,EAAEiB,SACF3H,EAAE,eAAegH,WAI5B9B,GAAG,QAAS,SAASwB,GAClB3B,OAAOC,KAAK,SACR0C,IAAKhB,EAAEiB,aAoGpB5H,GAAI8H,OAAQ5H","file":"game.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"/dist/\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n(function (io, $, Vue) {\n    'use strict';\n\n    var width = 800;\n    var height = 600;\n\n    var rightKey = 68;\n    var upKey = 87;\n    var leftKey = 65;\n    var downKey = 83;\n\n    var app = new Vue({\n        el: '#game',\n        data: {\n            messages: [{\n                type: 'info',\n                msg: 'Welcome to the game!'\n            }],\n            items: []\n        }\n    });\n\n    var canvas = document.getElementById('viewport');\n    var ctx = canvas.getContext('2d');\n    ctx.mozImageSmoothingEnabled = false;\n    ctx.webkitImageSmoothingEnabled = false;\n    ctx.msImageSmoothingEnabled = false;\n    ctx.imageSmoothingEnabled = false;\n    ctx.textAlign = 'center';\n\n    var textboxFocused = false;\n\n    var entities = {};\n    var map = [[0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0]];\n    var clientId = '';\n    var tileSize = 16;\n    var fps = 60;\n\n    var background = new Image();\n    background.src = '../img/grass.png';\n    var spritesheet = new Image();\n    spritesheet.src = '../img/spritesheet.png';\n\n    var commands = {\n        help: function help() {\n            app.messages.push({\n                type: 'info',\n                msg: 'Commands:\\n/help - List all commands'\n            });\n        },\n        debug: function debug(variable) {\n            socket.emit('clientDebug', variable + ': ' + eval(variable));\n        }\n    };\n\n    var socket = io();\n\n    socket.on('init', function (data) {\n        console.log(data);\n        entities = data.entities;\n        Object.keys(entities).forEach(function (id) {\n            entities[id].id = id;\n            entities[id].type = entities[id].types[entities[id].types.length - 1];\n        });\n        clientId = data.clientId;\n        setInterval(update, 1000 / fps);\n    });\n\n    socket.on('update', function (data) {\n        //console.log(entities, clientId);//console.log(data);\n        var _iteratorNormalCompletion = true;\n        var _didIteratorError = false;\n        var _iteratorError = undefined;\n\n        try {\n            for (var _iterator = data.removed[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                var removed = _step.value;\n\n                delete entities[removed.id];\n            }\n        } catch (err) {\n            _didIteratorError = true;\n            _iteratorError = err;\n        } finally {\n            try {\n                if (!_iteratorNormalCompletion && _iterator.return) {\n                    _iterator.return();\n                }\n            } finally {\n                if (_didIteratorError) {\n                    throw _iteratorError;\n                }\n            }\n        }\n\n        var instanceIds = Object.keys(data.entities);\n        for (var j = 0; j < instanceIds.length; j++) {\n            var instanceId = instanceIds[j];\n            var changes = Object.keys(data.entities[instanceId]);\n            for (var k = 0; k < changes.length; k++) {\n                var changedProp = changes[k];\n                var changedVal = data.entities[instanceId][changedProp];\n                if (!entities[instanceId]) {\n                    entities[instanceId] = data.entities[instanceId];\n                    entities[instanceId].type = entities[instanceId].types[entities[instanceId].types.length - 1];console.log(entities[instanceId].type);\n                    entities[instanceId].id = instanceId;\n                } else {\n                    entities[instanceId][changedProp] = changedVal;\n                    updateException('', instanceId, changedProp);\n                }\n            }\n        }\n        //app.$set(app, 'items', data.inventory.items);\n    });\n\n    socket.on('chatMsg', function (data) {\n        app.messages = app.messages.concat([data]);\n    });\n\n    $(document).ready(function () {\n\n        $('#viewport').on('mousedown', function (e) {\n            console.log('click');\n            var rect = canvas.getBoundingClientRect();\n            socket.emit('click', {\n                x: e.clientX - rect.left - width / 2 + entities[clientId].x,\n                y: e.clientY - rect.top - height / 2 + entities[clientId].y\n            });\n        });\n\n        $('#game-cont').on('contextmenu', function (e) {\n            e.preventDefault();\n        });\n\n        $('#chat-input, .login-input').on(\"focus\", function () {\n            textboxFocused = true;\n        }).on(\"blur\", function () {\n            textboxFocused = false;\n        });\n\n        $('#chat-cont').on('click', function (e) {\n            $('#chat-input').focus();\n        });\n\n        $('#chat-form').on('submit', function (e) {\n            e.preventDefault();\n            var message = $('#chat-input').val();\n            if (message.charAt(0) === '/') {\n                var inputs = message.substr(1).split(' ');\n                if (commands[inputs[0]]) {\n                    commands[inputs[0]].apply(null, inputs.slice(1));\n                } else {\n                    socket.emit('chatMsg', message.substr(0, 140));\n                }\n            } else {\n                socket.emit('chatMsg', message.substr(0, 140));\n            }\n            $('#chat-input').blur();\n            $('#chat-input').val('');\n            textboxFocused = false;\n        });\n    }).on('keydown', function (e) {\n        if (!textboxFocused) {\n            socket.emit('keyDown', {\n                key: e.keyCode\n            });\n            if ([rightKey, upKey, leftKey, downKey].indexOf(e.keyCode) !== -1) {\n                e.preventDefault();\n            }\n            if (e.keyCode === 84) {\n                $('#chat-input').focus();\n                e.preventDefault();\n            }\n            if (e.keyCode === 191) {\n                $('#chat-input').focus();\n            }\n        }\n    }).on('keyup', function (e) {\n        socket.emit('keyUp', {\n            key: e.keyCode\n        });\n    });\n\n    function updateException(objectType, instanceId, changedProp) {\n        var object = entities[instanceId];\n        if (objectType === 'Player') {\n            if (changedProp === 'x') {\n                object.xCenter = object.x + object.width / 2;\n            } else if (changedProp === 'y') {\n                object.yCenter = object.y + object.height / 2;\n            }\n        }\n    }\n\n    function update() {\n        ctx.clearRect(0, 0, width, height);\n        drawMap();\n        drawEntities();\n    }\n\n    function drawMap() {\n        var coors = getRelativeCoors([0, 0]);\n        var left = coors[0];\n        var top = coors[1];\n        for (var x = 0; x < width; x += 480) {\n            for (var y = 0; y < height; y += 480) {\n                ctx.drawImage(background, left + x, top + y, 480, 480);\n            }\n        }\n        /*map.forEach((row, y) => {\n            row.forEach((tile, x) => {\n                ctx.drawImage(spritesheet, (tile * (tileSize + 1)) % 968, tile * (tileSize + 1), tileSize, tileSize, left + x * tileSize, top + y * tileSize, tileSize, tileSize);\n            });\n        });*/\n    }\n\n    function drawEntities() {\n        Object.keys(entities).reduce(function (acc, id) {\n            return acc.concat(entities[id]);\n        }, []).sort(function (a, b) {\n            return a.y + a.height > b.y + b.height;\n        }).forEach(function (entity) {\n            var coors = getRelativeCoors([entity.x, entity.y]);\n            var x = coors[0];\n            var y = coors[1];\n            switch (entity.type) {\n                case 'Player':\n                    updatePosition(entity);\n                    ctx.fillStyle = 'black';\n                    ctx.fillText(entity.name, x + 8, y - 12);\n                    ctx.strokeRect(x, y, 16, 16);\n                    ctx.fillStyle = entity.color;\n                    ctx.fillRect(x, y, 16, 16);\n                    //if (id === clientId){\n                    ctx.fillStyle = 'black';\n                    ctx.fillRect(x - 4, y - 8, 24, 4);\n                    ctx.fillStyle = 'red';\n                    ctx.fillRect(x - 4, y - 8, 24 * entity.hp / entity.maxHp, 4);\n                    //}\n                    break;\n                case 'Bullet':\n                    updatePosition(entity);\n                    ctx.strokeRect(x, y, 16, 16);\n                    ctx.fillStyle = 'black';\n                    ctx.fillRect(x, y, 16, 16);\n                    break;\n                case 'Enemy':\n                    updatePosition(entity);\n                    ctx.strokeRect(x, y, 16, 16);\n                    ctx.fillStyle = '#922';\n                    ctx.fillRect(x, y, 16, 16);\n                    ctx.fillStyle = 'black';\n                    ctx.fillRect(x - 4, y - 8, 24, 4);\n                    ctx.fillStyle = 'red';\n                    ctx.fillRect(x - 4, y - 8, 24 * entity.hp / entity.maxHp, 4);\n                    ctx.fillStyle = 'black';\n                    ctx.fillText(entity.name, x + 8, y - 12);\n                    break;\n                case 'ItemDrop':\n                    updatePosition(entity);\n                    ctx.strokeRect(x, y, 16, 16);\n                    ctx.fillStyle = 'pink';\n                    ctx.fillRect(x, y, 16, 16);\n                    break;\n                default:\n                    console.warn('unrecognized type ' + entity.type);\n                    break;\n            }\n        });\n    }\n\n    function getRelativeCoors(coors) {\n        return entities[clientId] ? [coors[0] - entities[clientId].x + width / 2, coors[1] - entities[clientId].y + height / 2] : [0, 0];\n    }\n\n    function updatePosition(entity) {\n        entity.x += entity.hspeed / 2;\n        entity.y += entity.vspeed / 2;\n    }\n})(io, jQuery, Vue);\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// game.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 1793b269d9e6169dcf5e","(function(io, $, Vue){\n    'use strict';\n    \n    let width = 800;\n    let height = 600;\n    \n    let rightKey = 68;\n    let upKey = 87;\n    let leftKey = 65;\n    let downKey = 83;\n    \n    let app = new Vue({\n        el: '#game',\n        data: {\n            messages: [{\n                type: 'info',\n                msg: 'Welcome to the game!'\n            }],\n            items: []\n        }\n    });\n    \n    let canvas = document.getElementById('viewport');\n    let ctx = canvas.getContext('2d');\n    ctx.mozImageSmoothingEnabled = false;\n    ctx.webkitImageSmoothingEnabled = false;\n    ctx.msImageSmoothingEnabled = false;\n    ctx.imageSmoothingEnabled = false;\n    ctx.textAlign = 'center';\n    \n    let textboxFocused = false;\n    \n    let entities = {};\n    let map = [\n        [0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0],\n    ];\n    let clientId = '';\n    let tileSize = 16;\n    let fps = 60;\n    \n    let background = new Image();\n    background.src = '../img/grass.png';\n    let spritesheet = new Image();\n    spritesheet.src = '../img/spritesheet.png';\n    \n    const commands = {\n        help: function(){\n            app.messages.push({\n                type: 'info',\n                msg: 'Commands:\\n/help - List all commands'\n            });\n        },\n        debug: function(variable){\n            socket.emit('clientDebug', variable + ': ' + eval(variable));\n        }\n    };\n    \n    let socket = io();\n    \n    socket.on('init', function(data){console.log(data);\n        entities = data.entities;\n        Object.keys(entities).forEach(id => {\n            entities[id].id = id;\n            entities[id].type = entities[id].types[entities[id].types.length - 1];\n        });\n        clientId = data.clientId;\n        setInterval(update, 1000 / fps);\n    });\n    \n    socket.on('update', function(data){//console.log(entities, clientId);//console.log(data);\n        for (let removed of data.removed){\n            delete entities[removed.id];\n        }\n        \n        let instanceIds = Object.keys(data.entities);\n        for (let j = 0; j < instanceIds.length; j ++){\n            let instanceId = instanceIds[j];\n            let changes = Object.keys(data.entities[instanceId]);\n            for (let k = 0; k < changes.length; k ++){\n                let changedProp = changes[k];\n                let changedVal = data.entities[instanceId][changedProp];\n                if (!entities[instanceId]){\n                    entities[instanceId] = data.entities[instanceId];\n                    entities[instanceId].type = entities[instanceId].types[entities[instanceId].types.length - 1];console.log(entities[instanceId].type);\n                    entities[instanceId].id = instanceId;\n                } else {\n                    entities[instanceId][changedProp] = changedVal;\n                    updateException('', instanceId, changedProp);\n                }\n            }\n        }\n        //app.$set(app, 'items', data.inventory.items);\n    });\n    \n    socket.on('chatMsg', data => {\n        app.messages = app.messages.concat([data]);\n    });\n    \n    $(document)\n        .ready(function(){\n            \n            $('#viewport').on('mousedown', function(e){console.log('click');\n                let rect = canvas.getBoundingClientRect();\n                socket.emit('click', {\n                    x: e.clientX - rect.left - width / 2 + entities[clientId].x,\n                    y: e.clientY - rect.top - height / 2 + entities[clientId].y\n                });\n            });\n            \n            $('#game-cont').on('contextmenu', function(e){\n                e.preventDefault();\n            });\n            \n            $('#chat-input, .login-input')\n                .on(\"focus\", function(){\n                    textboxFocused = true;\n                })\n                .on(\"blur\", function(){\n                    textboxFocused = false;\n                });\n            \n            $('#chat-cont').on('click', function(e){\n                $('#chat-input').focus();\n            });\n            \n            $('#chat-form').on('submit', function(e){\n                e.preventDefault();\n                let message = $('#chat-input').val();\n                if (message.charAt(0) === '/'){\n                    let inputs = message.substr(1).split(' ');\n                    if (commands[inputs[0]]){\n                        commands[inputs[0]].apply(null, inputs.slice(1));\n                    } else {\n                        socket.emit('chatMsg', message.substr(0, 140));\n                    }\n                } else {\n                    socket.emit('chatMsg', message.substr(0, 140));\n                }\n                $('#chat-input').blur();\n                $('#chat-input').val('');\n                textboxFocused = false;\n                \n            });\n            \n        })\n        .on('keydown', function(e){\n            if (!textboxFocused){\n                socket.emit('keyDown', {\n                    key: e.keyCode\n                });\n                if ([rightKey, upKey, leftKey, downKey].indexOf(e.keyCode) !== -1){\n                    e.preventDefault();\n                }\n                if (e.keyCode === 84){\n                    $('#chat-input').focus();\n                    e.preventDefault();\n                }\n                if (e.keyCode === 191){\n                    $('#chat-input').focus();\n                }\n            }\n        })\n        .on('keyup', function(e){\n            socket.emit('keyUp', {\n                key: e.keyCode\n            });\n        });\n    \n    function updateException(objectType, instanceId, changedProp){\n        let object = entities[instanceId];\n        if (objectType === 'Player'){\n            if (changedProp === 'x'){\n                object.xCenter = object.x + object.width / 2;\n            } else if (changedProp === 'y'){\n                object.yCenter = object.y + object.height / 2;\n            }\n        }\n    }\n    \n    function update(){\n        ctx.clearRect(0, 0, width, height);\n        drawMap();\n        drawEntities();\n    }\n    \n    function drawMap(){\n        let coors = getRelativeCoors([0, 0]);\n        let left = coors[0];\n        let top = coors[1];\n        for (let x = 0; x < width; x += 480){\n            for (let y = 0; y < height; y += 480){\n                ctx.drawImage(background, left + x, top + y, 480, 480);\n            }\n        }\n        /*map.forEach((row, y) => {\n            row.forEach((tile, x) => {\n                ctx.drawImage(spritesheet, (tile * (tileSize + 1)) % 968, tile * (tileSize + 1), tileSize, tileSize, left + x * tileSize, top + y * tileSize, tileSize, tileSize);\n            });\n        });*/\n    }\n    \n    function drawEntities(){\n        Object.keys(entities)  \n            .reduce((acc, id) => acc.concat(entities[id]), [])\n            .sort((a, b) => a.y + a.height > b.y + b.height)\n            .forEach(entity => {\n                let coors = getRelativeCoors([entity.x, entity.y]);\n                let x = coors[0];\n                let y = coors[1];\n                switch (entity.type){\n                    case 'Player':\n                        updatePosition(entity);\n                        ctx.fillStyle = 'black';\n                        ctx.fillText(entity.name, x + 8, y - 12);\n                        ctx.strokeRect(x, y, 16, 16);\n                        ctx.fillStyle = entity.color;\n                        ctx.fillRect(x, y, 16, 16);\n                        //if (id === clientId){\n                            ctx.fillStyle = 'black';\n                            ctx.fillRect(x - 4, y - 8, 24, 4);\n                            ctx.fillStyle = 'red';\n                            ctx.fillRect(x - 4, y - 8, 24 * entity.hp / entity.maxHp, 4);\n                        //}\n                        break;\n                    case 'Bullet':\n                        updatePosition(entity);\n                        ctx.strokeRect(x, y, 16, 16);\n                        ctx.fillStyle = 'black';\n                        ctx.fillRect(x, y, 16, 16);\n                        break;\n                    case 'Enemy':\n                        updatePosition(entity);\n                        ctx.strokeRect(x, y, 16, 16);\n                        ctx.fillStyle = '#922';\n                        ctx.fillRect(x, y, 16, 16);\n                        ctx.fillStyle = 'black';\n                        ctx.fillRect(x - 4, y - 8, 24, 4);\n                        ctx.fillStyle = 'red';\n                        ctx.fillRect(x - 4, y - 8, 24 * entity.hp / entity.maxHp, 4);\n                        ctx.fillStyle = 'black';\n                        ctx.fillText(entity.name, x + 8, y - 12);\n                        break;\n                    case 'ItemDrop':\n                        updatePosition(entity);\n                        ctx.strokeRect(x, y, 16, 16);\n                        ctx.fillStyle = 'pink';\n                        ctx.fillRect(x, y, 16, 16);\n                        break;\n                    default:\n                        console.warn('unrecognized type ' + entity.type);\n                        break;\n                }\n            });\n    }\n    \n    function getRelativeCoors(coors){\n        return entities[clientId] ? [coors[0] - entities[clientId].x + width / 2, coors[1] - entities[clientId].y + height / 2] : [0, 0];\n    }\n    \n    function updatePosition(entity){\n        entity.x += entity.hspeed / 2;\n        entity.y += entity.vspeed / 2;\n    }\n    \n})(io, jQuery, Vue);\n\n\n\n// WEBPACK FOOTER //\n// ./src/client/js/src/game.js"],"sourceRoot":""}