!function(e){function t(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var i={};t.m=e,t.c=i,t.i=function(e){return e},t.d=function(e,i,n){t.o(e,i)||Object.defineProperty(e,i,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/dist/",t(t.s=0)}([function(module,exports,__webpack_require__){"use strict";!function(io,$,Vue){function update(){if(ctx.clearRect(0,0,width,height),drawMap(),entities.Player)for(var e in entities.Player){var t=entities.Player[e];updatePosition(t);var i=getRelativeCoors([t.x,t.y]),n=i[0],o=i[1];ctx.fillStyle="black",ctx.fillText(t.name,n,o-20),ctx.strokeRect(n-8,o-8,16,16),ctx.fillStyle=t.color,ctx.fillRect(n-8,o-8,16,16),ctx.fillStyle="black",ctx.fillRect(n-12,o-16,24,4),ctx.fillStyle="red",ctx.fillRect(n-12,o-16,24*t.hp/t.maxHp,4)}if(entities.Bullet)for(var c in entities.Bullet){var l=entities.Bullet[c];updatePosition(l);var a=getRelativeCoors([l.x,l.y]),r=a[0],s=a[1];ctx.strokeRect(r-8,s-8,16,16),ctx.fillStyle="black",ctx.fillRect(r-8,s-8,16,16)}if(entities.Enemy)for(var u in entities.Enemy){var f=entities.Enemy[u];updatePosition(f);var d=getRelativeCoors([f.x,f.y]),p=d[0],y=d[1];ctx.strokeRect(p-8,y-8,16,16),ctx.fillStyle="#922",ctx.fillRect(p-8,y-8,16,16),ctx.fillStyle="black",ctx.fillRect(p-12,y-16,24,4),ctx.fillStyle="red",ctx.fillRect(p-12,y-16,24*f.hp/f.maxHp,4),ctx.fillStyle="black",ctx.fillText(f.name,p,y-20)}}function drawMap(){for(var e=getRelativeCoors([0,0]),t=e[0],i=e[1],n=0;n<width;n+=480)for(var o=0;o<height;o+=480)ctx.drawImage(background,t+n,i+o,480,480)}function getRelativeCoors(e){return[e[0]-entities.Player[clientId].x+width/2,e[1]-entities.Player[clientId].y+height/2]}function updatePosition(e){e.x+=e.hspeed/2,e.y+=e.vspeed/2}var width=800,height=600,rightKey=68,upKey=87,leftKey=65,downKey=83,app=new Vue({el:"#game",data:{messages:[{type:"info",msg:"Welcome to the game!"}],items:[]}}),canvas=document.getElementById("viewport"),ctx=canvas.getContext("2d");ctx.textAlign="center";var textboxFocused=!1,entities={players:[],bullets:[]},clientId="",background=new Image;background.src="../img/grass.png";var commands={help:function(){app.messages.push({type:"info",msg:"Commands:\n/help - List all commands"})},debug:function debug(variable){socket.emit("clientDebug",variable+": "+eval(variable))}},socket=io();socket.on("init",function(e){entities=e.entities,console.log(entities),clientId=e.clientId,setInterval(update,20)}),socket.on("update",function(e){var t=!0,i=!1,n=void 0;try{for(var o,c=e.removed[Symbol.iterator]();!(t=(o=c.next()).done);t=!0){var l=o.value;delete entities[l.type][l.id]}}catch(e){i=!0,n=e}finally{try{!t&&c.return&&c.return()}finally{if(i)throw n}}for(var a=Object.keys(e.entities),r=0;r<a.length;r++)for(var s=a[r],u=Object.keys(e.entities[s]),f=0;f<u.length;f++)for(var d=u[f],p=Object.keys(e.entities[s][d]),y=0;y<p.length;y++){var x=p[y],v=e.entities[s][d][x];entities[s][d]?entities[s][d][x]=v:entities[s][d]=e.entities[s][d]}app.$set(app,"items",e.inventory.items)}),socket.on("chatMsg",function(e){app.messages=app.messages.concat([e])}),$(document).ready(function(){$("#viewport").on("click",function(e){var t=canvas.getBoundingClientRect();socket.emit("click",{x:e.clientX-t.left-width/2+entities.Player[clientId].x,y:e.clientY-t.top-height/2+entities.Player[clientId].y})}),$("#game-cont").on("contextmenu",function(e){e.preventDefault()}),$("#chat-input, .login-input").on("focus",function(){textboxFocused=!0}).on("blur",function(){textboxFocused=!1}),$("#chat-cont").on("click",function(e){$("#chat-input").focus()}),$("#chat-form").on("submit",function(e){var t=$("#chat-input").value();if("/"===t.charAt(0)){var i=t.substr(1).split(" ");commands[i[0]]?commands[i[0]].apply(null,i.slice(1)):socket.emit("chatMsg",t.substr(0,140))}else socket.emit("chatMsg",t.substr(0,140));$("#chat-input").blur(),$("#chat-input").value(""),textboxFocused=!1,e.preventDefault()})}).on("keydown",function(e){textboxFocused||(socket.emit("keyDown",{key:e.keyCode}),-1!==[68,87,65,83].indexOf(e.keyCode)&&e.preventDefault(),84===e.keyCode&&($("#chat-input").focus(),e.preventDefault()),191===e.keyCode&&$("#chat-input").focus())}).on("keyup",function(e){socket.emit("keyUp",{key:e.keyCode})})}(io,jQuery,Vue)}]);
//# sourceMappingURL=index.js.map